(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-29c088c4"],{"28d1":function(t,e,r){"use strict";r.d(e,"d",(function(){return i})),r.d(e,"f",(function(){return o})),r.d(e,"h",(function(){return s})),r.d(e,"b",(function(){return l})),r.d(e,"c",(function(){return u})),r.d(e,"e",(function(){return c})),r.d(e,"g",(function(){return d})),r.d(e,"a",(function(){return p}));var n=r("b775"),a=r("da71");function i(t){return Object(n["a"])({url:"".concat(a["a"].BASE_URL,"/stage/stage-list"),method:"get",params:t})}function o(t){return Object(n["a"])({url:"".concat(a["a"].BASE_URL,"/stage/release-stage"),method:"post",data:t})}function s(t){return Object(n["a"])({url:"".concat(a["a"].BASE_URL,"/stage/update-stage"),method:"post",data:t})}function l(t){return Object(n["a"])({url:"".concat(a["a"].BASE_URL,"/stage/delete-stage"),method:"get",params:t})}function u(t){return Object(n["a"])({url:"".concat(a["a"].BASE_URL,"/question/question-list-all"),method:"get",params:t})}function c(t){return Object(n["a"])({url:"".concat(a["a"].BASE_URL,"/question/release-question"),method:"post",data:t})}function d(t){return Object(n["a"])({url:"".concat(a["a"].BASE_URL,"/question/update-question"),method:"post",data:t})}function p(t){return Object(n["a"])({url:"".concat(a["a"].BASE_URL,"/question/delete-question"),method:"get",params:t})}},4266:function(t,e,r){"use strict";r.r(e);var n=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{staticClass:"question-container"},[r("div",{staticClass:"question-add"},[r("el-button",{attrs:{type:"primary"},on:{click:t.openDialog}},[t._v("\n      发布\n      "),r("el-dialog",{attrs:{title:"发布学习题目",visible:t.dialogVisible,"before-close":t.handleClose,width:"30%"},on:{"update:visible":function(e){t.dialogVisible=e}}},[r("el-form",{ref:"ruleForm",staticClass:"rule-form",attrs:{model:t.ruleForm,"label-width":"100px"}},[r("el-form-item",{attrs:{label:"阶段数",prop:"num"}},[r("el-input",{model:{value:t.ruleForm.num,callback:function(e){t.$set(t.ruleForm,"num",e)},expression:"ruleForm.num"}})],1),t._v(" "),r("el-form-item",{attrs:{label:"标题",prop:"tag"}},[r("el-input",{model:{value:t.ruleForm.title,callback:function(e){t.$set(t.ruleForm,"title",e)},expression:"ruleForm.title"}})],1),t._v(" "),r("el-form-item",{attrs:{label:"选项",prop:"title"}},[r("el-input",{attrs:{type:"textarea",rows:6,placeholder:"每条选项占一行，序号与选项之间用空格隔开"},model:{value:t.ruleForm.option,callback:function(e){t.$set(t.ruleForm,"option",e)},expression:"ruleForm.option"}})],1),t._v(" "),r("el-form-item",{attrs:{label:"正确答案",prop:"desc"}},[r("el-input",{model:{value:t.ruleForm.correct,callback:function(e){t.$set(t.ruleForm,"correct",e)},expression:"ruleForm.correct"}})],1),t._v(" "),r("el-form-item",{attrs:{label:"展示图"}},[r("div",{staticClass:"upload-container"},[t.ruleForm.banner?t._e():r("el-upload",{staticClass:"image-uploader",attrs:{data:t.dataObj,multiple:!1,"show-file-list":!1,"on-success":t.uploadBannerCallback,drag:"",action:"https://httpbin.org/post"}},[r("i",{staticClass:"el-icon-upload"}),t._v(" "),r("div",{staticClass:"el-upload__text"},[t._v("\n                  内容展示图：将文件拖到此处，或\n                  "),r("em",[t._v("点击上传")])])]),t._v(" "),t.ruleForm.banner?r("div",{staticClass:"image-preview",style:{backgroundImage:"url("+t.ruleForm.banner+")"}},[r("div",{staticClass:"image-preview-action",on:{click:t.removeBanner}},[r("i",{staticClass:"el-icon-delete"})])]):t._e()],1)])],1),t._v(" "),r("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[r("el-button",{attrs:{type:"primary"},on:{click:t.requestCallback}},[t._v("提交")])],1)],1)],1)],1),t._v(" "),r("div",{staticClass:"question-table"},[r("question-table",{attrs:{"table-data":t.tableData},on:{delete:t.refreshCallback,upload:t.uploadCallback}})],1)])},a=[],i=(r("28a5"),r("456d"),r("ac6a"),r("96cf"),r("3b8d")),o=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",[r("el-table",{staticStyle:{width:"100%"},attrs:{data:t.tableData,stripe:"stripe",border:"border"}},[r("el-table-column",{attrs:{type:"index",label:"编号",width:"120",align:"center"}}),t._v(" "),r("el-table-column",{attrs:{prop:"stage_num",label:"阶段",align:"center",width:"100"}}),t._v(" "),r("el-table-column",{attrs:{prop:"question_title",label:"标题",align:"center",width:"150"}}),t._v(" "),r("el-table-column",{attrs:{prop:"question_option",label:"选项",align:"center"}}),t._v(" "),r("el-table-column",{attrs:{prop:"question_correct",label:"正确答案",align:"center",width:"100"}}),t._v(" "),r("el-table-column",{attrs:{prop:"question_image",label:"展示图地址",align:"center"}}),t._v(" "),r("el-table-column",{attrs:{fixed:"right",label:"操作",width:"120",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[r("el-button",{attrs:{type:"text",size:"small"},nativeOn:{click:function(r){return r.preventDefault(),t.uploadRow(e.$index,t.tableData)}}},[t._v("编辑")]),t._v(" "),r("el-button",{attrs:{type:"text",size:"small"},nativeOn:{click:function(r){return r.preventDefault(),t.deleteRow(e.$index,t.tableData)}}},[t._v("删除")])]}}])})],1),t._v(" "),r("el-dialog",{attrs:{title:"删除资源",visible:t.dialogVisible,width:"30%"},on:{"update:visible":function(e){t.dialogVisible=e}}},[r("span",[t._v("是否删除")]),t._v(" "),r("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[r("el-button",{on:{click:t.closeDialog}},[t._v("取 消")]),t._v(" "),r("el-button",{attrs:{type:"primary"},on:{click:t.deleteCallback}},[t._v("确 定")])],1)])],1)},s=[],l=r("28d1"),u="delete",c="upload",d={props:{tableData:{type:Array,default:function(){return[]}}},data:function(){return{currentIdx:"",dialogVisible:!1,stripe:!0,border:!0}},methods:{openDialog:function(){this.dialogVisible=!0},closeDialog:function(){this.dialogVisible=!1},deleteCallback:function(){var t=Object(i["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,this.deleteRequest();case 2:this.closeDialog();case 3:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}(),deleteRow:function(t,e){this.currentIdx=t,this.openDialog()},deleteRequest:function(){var t=Object(i["a"])(regeneratorRuntime.mark((function t(){var e,r,n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e=this.$loading({lock:!0,text:"删除中...",spinner:"el-icon-loading",background:"rgba(0, 0, 0, 0.2)"}),t.prev=1,t.next=4,Object(l["a"])({question_id:this.tableData[this.currentIdx].question_id});case 4:if(r=t.sent,n=r.data,1!==n.noerr){t.next=8;break}throw new Error;case 8:e.close(),this.$message.success("删除成功"),this.$emit(u),t.next=17;break;case 13:t.prev=13,t.t0=t["catch"](1),e.close(),this.$message.error("删除失败");case 17:case"end":return t.stop()}}),t,this,[[1,13]])})));function e(){return t.apply(this,arguments)}return e}(),uploadRow:function(t){this.$emit(c,t)}}},p=d,m=r("2877"),b=Object(m["a"])(p,o,s,!1,null,null,null),h=b.exports,f={name:"Question",components:{QuestionTable:h},data:function(){return{id:0,btnTxt:"上传",ruleForm:{num:"",title:"",option:"",correct:"",banner:""},dataObj:{token:"",key:""},dialogVisible:!1,tableData:[]}},created:function(){var t=Object(i["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,this.getQuestionList();case 2:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}(),methods:{uploadBannerCallback:function(t){var e=t.files.file;this.ruleForm.banner=e},removeBanner:function(){this.ruleForm.banner=""},openDialog:function(){this.dialogVisible=!0},closeDialog:function(){var t=this;this.dialogVisible=!1,Object.keys(this.ruleForm).forEach((function(e){t.ruleForm[e]=""}))},requestCallback:function(){0===this.id?this.releaseQuestion():this.updateQuestion()},uploadCallback:function(t){this.ruleForm.num=this.tableData[t].stage_num,this.ruleForm.title=this.tableData[t].question_title,this.ruleForm.option=this.reverseFormat(this.tableData[t].question_option),this.ruleForm.correct=this.tableData[t].question_correct,this.ruleForm.banner=this.tableData[t].question_image,this.id=this.tableData[t].question_id,this.openDialog()},updateQuestion:function(){var t=Object(i["a"])(regeneratorRuntime.mark((function t(){var e,r,n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e=this.$loading({lock:!0,text:"加载中...",spinner:"el-icon-loading",background:"rgba(0, 0, 0, 0.2)"}),t.prev=1,t.next=4,Object(l["g"])({question_id:this.id,stage_num:this.ruleForm.num,question_title:this.ruleForm.title,question_option:this.format(this.ruleForm.option),question_correct:this.ruleForm.correct,question_image:this.ruleForm.banner});case 4:if(r=t.sent,n=r.data,1!==n.noerr){t.next=8;break}throw new Error;case 8:this.getQuestionList(),this.$message.success("更新成功"),t.next=15;break;case 12:t.prev=12,t.t0=t["catch"](1),this.$message.error("更新失败");case 15:return t.prev=15,this.closeDialog(),e.close(),this.id=0,t.finish(15);case 20:case"end":return t.stop()}}),t,this,[[1,12,15,20]])})));function e(){return t.apply(this,arguments)}return e}(),releaseQuestion:function(){var t=Object(i["a"])(regeneratorRuntime.mark((function t(){var e,r,n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e=this.$loading({lock:!0,text:"加载中...",spinner:"el-icon-loading",background:"rgba(0, 0, 0, 0.2)"}),t.prev=1,t.next=4,Object(l["e"])({stage_num:this.ruleForm.num,question_title:this.ruleForm.title,question_option:this.format(this.ruleForm.option),question_correct:this.ruleForm.correct,question_image:this.ruleForm.banner});case 4:if(r=t.sent,n=r.data,1!==n.noerr){t.next=8;break}throw new Error(n.message);case 8:this.$message.success("上传成功"),this.getQuestionList(),t.next=15;break;case 12:t.prev=12,t.t0=t["catch"](1),this.$message.error(t.t0.message);case 15:return t.prev=15,this.closeDialog(),e.close(),this.id=0,t.finish(15);case 20:case"end":return t.stop()}}),t,this,[[1,12,15,20]])})));function e(){return t.apply(this,arguments)}return e}(),getQuestionList:function(){var t=Object(i["a"])(regeneratorRuntime.mark((function t(){var e,r,n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e=this.$loading({lock:!0,text:"加载中...",spinner:"el-icon-loading",background:"rgba(0, 0, 0, 0.2)"}),t.prev=1,t.next=4,Object(l["c"])();case 4:if(r=t.sent,n=r.data,1!==n.noerr){t.next=8;break}throw new Error;case 8:this.tableData=n.data,e.close(),t.next=16;break;case 12:t.prev=12,t.t0=t["catch"](1),e.close(),this.$message.error("网络请求失败");case 16:case"end":return t.stop()}}),t,this,[[1,12]])})));function e(){return t.apply(this,arguments)}return e}(),refreshCallback:function(){this.getQuestionList()},handleClose:function(t){var e=this;this.$confirm("确认关闭？").then((function(r){e.id=0,Object.keys(e.ruleForm).forEach((function(t){e.ruleForm[t]=""})),t()})).catch((function(t){}))},format:function(t){var e=t.split("\n").reduce((function(t,e){var r=e.split(" ");return t[r[0]]=r[1],t}),{});return JSON.stringify(e)},reverseFormat:function(t){var e=JSON.parse(t);return Object.keys(e).map((function(t){return"".concat(t," ").concat(e[t])})).join("\n")}}},g=f,v=(r("d308"),Object(m["a"])(g,n,a,!1,null,"1fc68a44",null));e["default"]=v.exports},"456d":function(t,e,r){var n=r("4bf8"),a=r("0d58");r("5eda")("keys",(function(){return function(t){return a(n(t))}}))},"57d8":function(t,e,r){},"5eda":function(t,e,r){var n=r("5ca1"),a=r("8378"),i=r("79e5");t.exports=function(t,e){var r=(a.Object||{})[t]||Object[t],o={};o[t]=e(r),n(n.S+n.F*i((function(){r(1)})),"Object",o)}},d308:function(t,e,r){"use strict";var n=r("57d8"),a=r.n(n);a.a}}]);