(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-31500b3c"],{"28d1":function(e,t,a){"use strict";a.d(t,"d",(function(){return i})),a.d(t,"f",(function(){return s})),a.d(t,"h",(function(){return l})),a.d(t,"b",(function(){return o})),a.d(t,"c",(function(){return c})),a.d(t,"e",(function(){return u})),a.d(t,"g",(function(){return d})),a.d(t,"a",(function(){return g}));var r=a("b775"),n=a("da71");function i(e){return Object(r["a"])({url:"".concat(n["a"].BASE_URL,"/stage/stage-list"),method:"get",params:e})}function s(e){return Object(r["a"])({url:"".concat(n["a"].BASE_URL,"/stage/release-stage"),method:"post",data:e})}function l(e){return Object(r["a"])({url:"".concat(n["a"].BASE_URL,"/stage/update-stage"),method:"post",data:e})}function o(e){return Object(r["a"])({url:"".concat(n["a"].BASE_URL,"/stage/delete-stage"),method:"get",params:e})}function c(e){return Object(r["a"])({url:"".concat(n["a"].BASE_URL,"/question/question-list-all"),method:"get",params:e})}function u(e){return Object(r["a"])({url:"".concat(n["a"].BASE_URL,"/question/release-question"),method:"post",data:e})}function d(e){return Object(r["a"])({url:"".concat(n["a"].BASE_URL,"/question/update-question"),method:"post",data:e})}function g(e){return Object(r["a"])({url:"".concat(n["a"].BASE_URL,"/question/delete-question"),method:"get",params:e})}},"366f":function(e,t,a){},"456d":function(e,t,a){var r=a("4bf8"),n=a("0d58");a("5eda")("keys",(function(){return function(e){return n(r(e))}}))},"5eda":function(e,t,a){var r=a("5ca1"),n=a("8378"),i=a("79e5");e.exports=function(e,t){var a=(n.Object||{})[e]||Object[e],s={};s[e]=t(a),r(r.S+r.F*i((function(){a(1)})),"Object",s)}},"7e03":function(e,t,a){"use strict";a.r(t);var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"stage-container"},[a("div",{staticClass:"stage-add"},[a("el-button",{attrs:{type:"primary"},on:{click:e.openDialog}},[e._v("\n      发布\n      "),a("el-dialog",{attrs:{title:"发布学习阶段",visible:e.dialogVisible,"before-close":e.handleClose,width:"30%"},on:{"update:visible":function(t){e.dialogVisible=t}}},[a("el-form",{ref:"ruleForm",staticClass:"rule-form",attrs:{model:e.ruleForm,"label-width":"100px"}},[a("el-form-item",{attrs:{label:"阶段数",prop:"num"}},[a("el-input",{model:{value:e.ruleForm.num,callback:function(t){e.$set(e.ruleForm,"num",t)},expression:"ruleForm.num"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"标签",prop:"tag"}},[a("el-input",{model:{value:e.ruleForm.tag,callback:function(t){e.$set(e.ruleForm,"tag",t)},expression:"ruleForm.tag"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"标题",prop:"title"}},[a("el-input",{model:{value:e.ruleForm.title,callback:function(t){e.$set(e.ruleForm,"title",t)},expression:"ruleForm.title"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"描述",prop:"desc"}},[a("el-input",{model:{value:e.ruleForm.desc,callback:function(t){e.$set(e.ruleForm,"desc",t)},expression:"ruleForm.desc"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"展示图"}},[a("div",{staticClass:"upload-container"},[e.ruleForm.banner?e._e():a("el-upload",{staticClass:"image-uploader",attrs:{data:e.dataObj,multiple:!1,"show-file-list":!1,"on-success":e.uploadBannerCallback,drag:"",action:"https://httpbin.org/post"}},[a("i",{staticClass:"el-icon-upload"}),e._v(" "),a("div",{staticClass:"el-upload__text"},[e._v("\n                  内容展示图：将文件拖到此处，或\n                  "),a("em",[e._v("点击上传")])])]),e._v(" "),e.ruleForm.banner?a("div",{staticClass:"image-preview",style:{backgroundImage:"url("+e.ruleForm.banner+")"}},[a("div",{staticClass:"image-preview-action",on:{click:e.removeBanner}},[a("i",{staticClass:"el-icon-delete"})])]):e._e()],1)])],1),e._v(" "),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{type:"primary"},on:{click:e.requestCallback}},[e._v("提交")])],1)],1)],1)],1),e._v(" "),a("div",{staticClass:"stage-table"},[a("stage-table",{attrs:{"table-data":e.tableData},on:{delete:e.refreshCallback,upload:e.uploadCallback}})],1)])},n=[],i=(a("456d"),a("ac6a"),a("96cf"),a("3b8d")),s=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("el-table",{staticStyle:{width:"100%"},attrs:{data:e.tableData,stripe:"stripe",border:"border"}},[a("el-table-column",{attrs:{type:"index",label:"编号",width:"120",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{prop:"stage_tag",label:"标签",align:"center",width:"100"}}),e._v(" "),a("el-table-column",{attrs:{prop:"stage_title",label:"标题",align:"center",width:"150"}}),e._v(" "),a("el-table-column",{attrs:{prop:"stage_num",label:"阶段",align:"center",width:"100"}}),e._v(" "),a("el-table-column",{attrs:{prop:"stage_description",label:"描述",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{prop:"stage_banner",label:"展示图地址",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{prop:"userCount",label:"学习人数",align:"center",width:"100"}}),e._v(" "),a("el-table-column",{attrs:{fixed:"right",label:"操作",width:"120",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{type:"text",size:"small"},nativeOn:{click:function(a){return a.preventDefault(),e.uploadRow(t.$index,e.tableData)}}},[e._v("编辑")]),e._v(" "),a("el-button",{attrs:{type:"text",size:"small"},nativeOn:{click:function(a){return a.preventDefault(),e.deleteRow(t.$index,e.tableData)}}},[e._v("删除")])]}}])})],1),e._v(" "),a("el-dialog",{attrs:{title:"删除资源",visible:e.dialogVisible,width:"30%"},on:{"update:visible":function(t){e.dialogVisible=t}}},[a("span",[e._v("是否删除")]),e._v(" "),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:e.closeDialog}},[e._v("取 消")]),e._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:e.deleteCallback}},[e._v("确 定")])],1)])],1)},l=[],o=a("28d1"),c="delete",u="upload",d={props:{tableData:{type:Array,default:function(){return[]}}},data:function(){return{currentIdx:"",dialogVisible:!1,stripe:!0,border:!0}},methods:{openDialog:function(){this.dialogVisible=!0},closeDialog:function(){this.dialogVisible=!1},deleteCallback:function(){var e=Object(i["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,this.deleteRequest();case 2:this.closeDialog();case 3:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}(),deleteRow:function(e,t){this.currentIdx=e,this.openDialog()},deleteRequest:function(){var e=Object(i["a"])(regeneratorRuntime.mark((function e(){var t,a,r;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t=this.$loading({lock:!0,text:"删除中...",spinner:"el-icon-loading",background:"rgba(0, 0, 0, 0.2)"}),e.prev=1,e.next=4,Object(o["b"])({stage_id:this.tableData[this.currentIdx].stage_id});case 4:if(a=e.sent,r=a.data,console.log(r),1!==r.noerr){e.next=9;break}throw new Error;case 9:t.close(),this.$message.success("删除成功"),this.$emit(c),e.next=18;break;case 14:e.prev=14,e.t0=e["catch"](1),t.close(),this.$message.error("删除失败");case 18:case"end":return e.stop()}}),e,this,[[1,14]])})));function t(){return e.apply(this,arguments)}return t}(),uploadRow:function(e){this.$emit(u,e)}}},g=d,b=a("2877"),p=Object(b["a"])(g,s,l,!1,null,null,null),m=p.exports,h={name:"Stage",components:{StageTable:m},data:function(){return{id:0,btnTxt:"上传",ruleForm:{num:"",title:"",tag:"",desc:"",banner:""},dataObj:{token:"",key:""},dialogVisible:!1,tableData:[]}},created:function(){var e=Object(i["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,this.getStageList();case 2:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}(),methods:{uploadBannerCallback:function(e){var t=e.files.file;this.ruleForm.banner=t},removeBanner:function(){this.ruleForm.banner=""},openDialog:function(){this.dialogVisible=!0},closeDialog:function(){var e=this;this.dialogVisible=!1,Object.keys(this.ruleForm).forEach((function(t){e.ruleForm[t]=""}))},requestCallback:function(){0===this.id?this.releaseStage():this.updateStage()},uploadCallback:function(e){this.ruleForm.num=this.tableData[e].stage_num,this.ruleForm.title=this.tableData[e].stage_title,this.ruleForm.tag=this.tableData[e].stage_tag,this.ruleForm.desc=this.tableData[e].stage_description,this.ruleForm.banner=this.tableData[e].stage_banner,this.id=this.tableData[e].stage_id,this.openDialog()},updateStage:function(){var e=Object(i["a"])(regeneratorRuntime.mark((function e(){var t,a,r;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t=this.$loading({lock:!0,text:"加载中...",spinner:"el-icon-loading",background:"rgba(0, 0, 0, 0.2)"}),e.prev=1,e.next=4,Object(o["h"])({stage_id:this.id,stage_num:this.ruleForm.num,stage_title:this.ruleForm.title,stage_tag:this.ruleForm.tag,stage_description:this.ruleForm.desc,stage_image:this.ruleForm.banner});case 4:if(a=e.sent,r=a.data,1!==r.noerr){e.next=8;break}throw new Error;case 8:this.getStageList(),this.$message.success("更新成功"),e.next=15;break;case 12:e.prev=12,e.t0=e["catch"](1),this.$message.error("更新失败");case 15:return e.prev=15,this.closeDialog(),t.close(),this.id=0,e.finish(15);case 20:case"end":return e.stop()}}),e,this,[[1,12,15,20]])})));function t(){return e.apply(this,arguments)}return t}(),releaseStage:function(){var e=Object(i["a"])(regeneratorRuntime.mark((function e(){var t,a,r;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t=this.$loading({lock:!0,text:"加载中...",spinner:"el-icon-loading",background:"rgba(0, 0, 0, 0.2)"}),e.prev=1,e.next=4,Object(o["f"])({stage_num:this.ruleForm.num,stage_tag:this.ruleForm.tag,stage_title:this.ruleForm.title,stage_description:this.ruleForm.desc,stage_image:this.ruleForm.banner});case 4:if(a=e.sent,r=a.data,1!==r.noerr){e.next=8;break}throw new Error(r.message);case 8:this.$message.success("上传成功"),this.getStageList(),e.next=15;break;case 12:e.prev=12,e.t0=e["catch"](1),this.$message.error(e.t0.message);case 15:return e.prev=15,this.closeDialog(),t.close(),this.id=0,e.finish(15);case 20:case"end":return e.stop()}}),e,this,[[1,12,15,20]])})));function t(){return e.apply(this,arguments)}return t}(),getStageList:function(){var e=Object(i["a"])(regeneratorRuntime.mark((function e(){var t,a,r;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t=this.$loading({lock:!0,text:"加载中...",spinner:"el-icon-loading",background:"rgba(0, 0, 0, 0.2)"}),e.prev=1,e.next=4,Object(o["d"])();case 4:if(a=e.sent,r=a.data,1!==r.noerr){e.next=8;break}throw new Error;case 8:this.tableData=r.data,t.close(),e.next=16;break;case 12:e.prev=12,e.t0=e["catch"](1),t.close(),this.$message.error("网络请求失败");case 16:case"end":return e.stop()}}),e,this,[[1,12]])})));function t(){return e.apply(this,arguments)}return t}(),refreshCallback:function(){this.getStageList()},handleClose:function(e){var t=this;this.$confirm("确认关闭？").then((function(a){t.id=0,Object.keys(t.ruleForm).forEach((function(e){t.ruleForm[e]=""})),e()})).catch((function(e){}))}}},f=h,v=(a("cc9b"),Object(b["a"])(f,r,n,!1,null,"0ce8182c",null));t["default"]=v.exports},cc9b:function(e,t,a){"use strict";var r=a("366f"),n=a.n(r);n.a}}]);